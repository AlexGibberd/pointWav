function [ K ] = mexicanKernel( t1,t2,a,s,M )
%MEXICANFNKERNEL Samples the kernel correspoinding to the smoothed mexican
%hat wavelet
% Inputs:
%   t1,t2 - input time points
%   t0 - center of wavelet (point in time we are trying to estimate for)
%   a - scale
%   s - sigma parameter
%   M - smoothing window width

K = (4/3).*a.^(-5).*M.^(-1).*pi.^(-1/2).*s.^(-6).*((1/32).*a.*exp(1) ...
 .^((-1/4).*a.^(-2).*s.^(-2).*(M.^2+2.*(t1.^2+t2.^2))).*s.*(2.*a.* ...
  exp(1).^((1/2).*a.^(-2).*M.*s.^(-2).*(t1+t2)).*s.*(M+(-1).*t1+(-1) ...
  .*t2).*((-1).*M.^2+2.*a.^2.*s.^2+t1.^2+(-6).*t1.*t2+t2.^2+2.*M.*( ...
  t1+t2))+(-1).*exp(1).^((1/4).*a.^(-2).*s.^(-2).*(M.^2+(t1+t2).^2)) ...
  .*pi.^(1/2).*(12.*a.^4.*s.^4+(-12).*a.^2.*s.^2.*(t1+(-1).*t2).^2+( ...
  t1+(-1).*t2).^4).*erf((1/2).*a.^(-1).*s.^(-1).*((-1).*M+t1+t2)))+( ...
  -1/32).*a.*exp(1).^((-1/4).*a.^(-2).*s.^(-2).*(M.^2+2.*(t1.^2+ ...
 t2.^2))).*s.*((-2).*a.*exp(1).^((-1/2).*a.^(-2).*M.*s.^(-2).*(t1+ ...
  t2)).*s.*(M+t1+t2).*((-1).*M.^2+2.*a.^2.*s.^2+t1.^2+(-6).*t1.*t2+ ...
  t2.^2+(-2).*M.*(t1+t2))+(-1).*exp(1).^((1/4).*a.^(-2).*s.^(-2).*( ...
  M.^2+(t1+t2).^2)).*pi.^(1/2).*(12.*a.^4.*s.^4+(-12).*a.^2.*s.^2.*( ...
  t1+(-1).*t2).^2+(t1+(-1).*t2).^4).*erf((1/2).*a.^(-1).*s.^(-1).*( ...
  M+t1+t2))));

end

